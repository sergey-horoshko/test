import{b as k,d as V,j as _,k as x,l as I,r as d,c as m,h as p,f as a,t as i,i as n,w as u,m as b,n as h,p as P,q as S,u as C,s as z}from"./index-Ca4wjZwH.js";import{s as B,u as F,t as M}from"./request-BAP1f-9B.js";import{u as N}from"./me-DjfcdeTZ.js";import{r as $,e as T,m as j}from"./i18n-validators-B_4ieep4.js";function q(e){return B({url:"/login/",method:"post",data:e})}const E=V({setup(){const e=_(!0),t=x({email:"",password:null,pending:null}),v=C(),g=N(),{getProfile:w}=g,y=I(()=>({email:{required:$,email:T},password:{required:$,minLength:j(6)}})),r=F(y,t);return{typePassword:e,form:t,v:r,validate:({prop:l})=>{const s=r.value.$errors.find(o=>o.$property===l);return s&&s.$message},onSubmit:async()=>{if(r.value.$touch(),!t.pending&&await r.value.$validate()){t.pending=!0;try{const l={email:t.email.toLowerCase(),password:t.password},s=await q(l);console.log(s),s!=null&&s.access_token?(z(s.access_token),await w(),await v.push("/")):M({title:"Ошибка",body:"Произошла ошибка, свяжитесь с администратором"})}catch(l){console.log(l)}finally{t.pending=!1}}}}}}),L={class:"rounded-lg p-5 md:bg-white md:p-12 md:shadow-xl dark:md:bg-dark-content"},A={class:"flex w-full items-center justify-between gap-3"},R={class:"text-2xl font-bold"},U={class:"mt-1"},D={class:"flex flex-col"},G={class:"mb-1 text-xs font-medium text-gray-500 dark:text-gray-300"},H={key:0,class:"invalid mt-1 text-red-400"},J={class:"relative mt-6 flex flex-col"},K={class:"mb-1 text-xs font-medium text-gray-500 dark:text-gray-300"},O={key:0,class:"pi pi-eye",style:{"font-size":"1.1rem"}},Q={key:1,class:"pi pi-eye-slash",style:{"font-size":"1.1rem"}},W={key:0,class:"invalid mt-1 text-red-400"},X={class:"mt-1 text-right"};function Y(e,t,v,g,w,y){const r=d("router-link"),f=d("InputIcon"),c=d("InputText"),l=d("IconField"),s=d("Button");return m(),p("div",L,[a("div",A,[a("span",R,i(e.$t("auth.title")),1),n(r,{class:"font-semibold text-blue-600 dark:text-blue-500",to:"/registration"},{default:u(()=>[b(i(e.$t("auth.registration")),1)]),_:1})]),a("div",U,i(e.$t("auth.description")),1),a("form",{onSubmit:t[5]||(t[5]=S((...o)=>e.onSubmit&&e.onSubmit(...o),["prevent"])),class:"mt-8"},[a("div",D,[a("label",G,i(e.$t("form.labelEmail")),1),n(l,{iconPosition:"left"},{default:u(()=>[n(f,{class:"pi pi-envelope"}),n(c,{modelValue:e.form.email,"onUpdate:modelValue":t[0]||(t[0]=o=>e.form.email=o),modelModifiers:{trim:!0},onFocus:t[1]||(t[1]=o=>e.v.$reset()),invalid:!!e.validate({prop:"email"}),type:"text",size:"large"},null,8,["modelValue","invalid"])]),_:1}),e.validate({prop:"email"})?(m(),p("div",H,i(e.validate({prop:"email"})),1)):h("",!0)]),a("div",J,[a("label",K,i(e.$t("form.labelPassword")),1),n(l,{iconPosition:"left"},{default:u(()=>[n(f,{class:"pi pi-lock"}),n(c,{modelValue:e.form.password,"onUpdate:modelValue":t[2]||(t[2]=o=>e.form.password=o),modelModifiers:{trim:!0},onFocus:t[3]||(t[3]=o=>e.v.$reset()),invalid:!!e.validate({prop:"password"}),type:e.typePassword?"password":"text",size:"large"},null,8,["modelValue","invalid","type"])]),_:1}),a("button",{class:"toggle p-2",type:"button",onClick:t[4]||(t[4]=o=>e.typePassword=!e.typePassword)},[e.typePassword?(m(),p("i",O)):(m(),p("i",Q))]),e.validate({prop:"password"})?(m(),p("div",W,i(e.validate({prop:"password"})),1)):h("",!0)]),a("div",X,[n(r,{class:"text-xs font-medium text-blue-600 dark:text-blue-500",to:"/reset"},{default:u(()=>[b(i(e.$t("auth.reset")),1)]),_:1})]),n(s,{class:P([{"-loading":e.form.pending},"justify-content-center mt-6 flex w-full bg-blue-600 p-4 text-center text-white"]),loading:e.form.pending,label:e.form.pending?"":e.$t("form.buttonSignIn"),rounded:"",type:"submit"},null,8,["class","loading","label"])],32)])}const se=k(E,[["render",Y]]);export{se as default};
